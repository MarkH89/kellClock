"use strict";function kellClock(t){if(!t.selector||!t.dateEndString)return null;var e={selector:t.selector,dateEndString:t.dateEndString,daysAsHours:t.daysAsHours||!1,textContents:t.textContents||{d:"d",h:"h",m:"m",s:"s"},minPadding:t.minPadding||2,debugMode:t.debugMode||!1};this._data={_selector:e.selector,_initialised:!1,_daysAsHours:e.daysAsHours,_textContents:e.textContents,_dateEndString:e.dateEndString,_dateEnd:0,_container:null,_timeLeft:0,_timeNow:0,_d:864e5,_h:36e5,_m:6e4,_minPadding:e.minPadding,_fracts:{d:null,h:null,m:null,s:null},_debugMode:e.debugMode},this._data._initialised=this._preflight()}kellClock.prototype._preflight=function(){var t=this._data;if(t._initialised)return!0;if(null==(t._container=document.querySelector(t._selector)))return this._logger("No container for clock"),!1;if(null!=t._container.dataset.clockStatus)return this._logger("Clock already init'd on this selector!"),!1;if(t._dateEnd=new Date(t._dateEndString).getTime(),null==t._dateEnd||0==t._dateEnd||null==t._dateEnd||isNaN(t._dateEnd))return this._logger("Failed to find end date"),!1;t._container.dataset.clockStatus="init";for(var e=Object.keys(t._fracts),n=0;n<e.length;n++){var i=e[n];t._fracts[i]=document.createElement("span"),t._fracts[i].className="".concat(t._selector,"__").concat(i," kellClock-fraction")}return!0},kellClock.prototype.run=function(){var t=this._data;if(t._initialised){for(var e in t._fracts)if(("d"!=e||!t._daysAsHours)&&(t._container.appendChild(t._fracts[e]),t._textContents&&0!==Object.keys(t._textContents).length&&t._textContents.constructor===Object)){var n=document.createElement("span");n.className="label",n.textContent=t._textContents[e],t._container.appendChild(n)}t._timeNow=(new Date).getTime(),t._timeLeft=t._dateEnd-t._timeNow,t.timeLeft<0?t.selector.textContent="EXPIRED":this._update()}else this._logger("Clock failed initialisation")},kellClock.prototype._update=function(){var t=this,e=this._data;e._timeNow=(new Date).getTime(),e.timeLeft=e._dateEnd-e._timeNow,e.timeLeft<0?(e._selector.textContent="EXPIRED",e._container.dataset.clockStatus="expired"):(e._container.dataset.clockStatus="running",e._daysAsHours||(e._fracts.d.textContent=this._stringPad(Math.floor(e.timeLeft/e._d))),e._fracts.h.textContent=e._daysAsHours?this._stringPad(Math.floor(e.timeLeft%e._d/e._h)+24*Math.floor(e.timeLeft/e._d)):this._stringPad(Math.floor(e.timeLeft%e._d/e._h)),e._fracts.m.textContent=this._stringPad(Math.floor(e.timeLeft%e._h/e._m)),e._fracts.s.textContent=this._stringPad(Math.floor(e.timeLeft%e._m/1e3)),window.setTimeout(function(){t._update()},1e3))},kellClock.prototype._stringPad=function(t){var e=this._data;return String(t).split("").length>=e._minPadding?String(t):String("0"+t).slice(-e._minPadding)},kellClock.prototype._logger=function(t){this._data._debugMode&&console.log(t)};